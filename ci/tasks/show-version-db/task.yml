---
platform: linux

image_resource:
  type: registry-image
  source:
    repository: python
    tag: "3.11-slim"

inputs:
  - name: release-monitor-repo
    path: /app

params:
  # Artifactory configuration
  ARTIFACTORY_URL:
  ARTIFACTORY_REPOSITORY:
  ARTIFACTORY_API_KEY:
  ARTIFACTORY_USERNAME:
  ARTIFACTORY_PASSWORD:
  ARTIFACTORY_SKIP_SSL_VERIFICATION:
  # S3 configuration
  S3_ENDPOINT:
  S3_SKIP_SSL_VERIFICATION:
  AWS_ACCESS_KEY_ID:
  AWS_SECRET_ACCESS_KEY:
  VERSION_DB_S3_BUCKET:
  VERSION_DB_S3_PREFIX:
  VERSION_DB_S3_REGION:
  # Local configuration
  VERSION_DB_PATH:
  DOWNLOAD_DIR:

run:
  path: /bin/bash
  args:
    - -exc
    - |
      set -e
      # Navigate to repo directory
      cd /app
      # Install required dependencies
      ./ci/tasks/show-version-db/task.sh
